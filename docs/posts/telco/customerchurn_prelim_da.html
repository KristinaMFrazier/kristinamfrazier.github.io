<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kristina Frazier &amp; Lauren Manturi">
<meta name="dcterms.date" content="2024-12-04">

<title>Appendix – Kristina Frazier</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Kristina Frazier</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KristinaMFrazier"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com//in/kristinamfrazier/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Appendix</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kristina Frazier &amp; Lauren Manturi </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 4, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="descriptive-analysis" class="level1">
<h1>Descriptive Analysis</h1>
<p>This section is an initial data analysis of all variables as an early assessment of fit for predictive modeling.</p>
<section id="summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(klaR)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tree)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>churn <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'WA_Fn-UseC_-Telco-Customer-Churn.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># look at NA values - might be able to compute regression model to impute those values</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 7,043
Columns: 21
$ customerID       &lt;chr&gt; "7590-VHVEG", "5575-GNVDE", "3668-QPYBK", "7795-CFOCW…
$ gender           &lt;chr&gt; "Female", "Male", "Male", "Male", "Female", "Female",…
$ SeniorCitizen    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Partner          &lt;chr&gt; "Yes", "No", "No", "No", "No", "No", "No", "No", "Yes…
$ Dependents       &lt;chr&gt; "No", "No", "No", "No", "No", "No", "Yes", "No", "No"…
$ tenure           &lt;dbl&gt; 1, 34, 2, 45, 2, 8, 22, 10, 28, 62, 13, 16, 58, 49, 2…
$ PhoneService     &lt;chr&gt; "No", "Yes", "Yes", "No", "Yes", "Yes", "Yes", "No", …
$ MultipleLines    &lt;chr&gt; "No phone service", "No", "No", "No phone service", "…
$ InternetService  &lt;chr&gt; "DSL", "DSL", "DSL", "DSL", "Fiber optic", "Fiber opt…
$ OnlineSecurity   &lt;chr&gt; "No", "Yes", "Yes", "Yes", "No", "No", "No", "Yes", "…
$ OnlineBackup     &lt;chr&gt; "Yes", "No", "Yes", "No", "No", "No", "Yes", "No", "N…
$ DeviceProtection &lt;chr&gt; "No", "Yes", "No", "Yes", "No", "Yes", "No", "No", "Y…
$ TechSupport      &lt;chr&gt; "No", "No", "No", "Yes", "No", "No", "No", "No", "Yes…
$ StreamingTV      &lt;chr&gt; "No", "No", "No", "No", "No", "Yes", "Yes", "No", "Ye…
$ StreamingMovies  &lt;chr&gt; "No", "No", "No", "No", "No", "Yes", "No", "No", "Yes…
$ Contract         &lt;chr&gt; "Month-to-month", "One year", "Month-to-month", "One …
$ PaperlessBilling &lt;chr&gt; "Yes", "No", "Yes", "No", "Yes", "Yes", "Yes", "No", …
$ PaymentMethod    &lt;chr&gt; "Electronic check", "Mailed check", "Mailed check", "…
$ MonthlyCharges   &lt;dbl&gt; 29.85, 56.95, 53.85, 42.30, 70.70, 99.65, 89.10, 29.7…
$ TotalCharges     &lt;dbl&gt; 29.85, 1889.50, 108.15, 1840.75, 151.65, 820.50, 1949…
$ Churn            &lt;chr&gt; "No", "No", "Yes", "No", "Yes", "Yes", "No", "No", "Y…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removes 21 observations</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>churn <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(churn)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 7,032
Columns: 21
$ customerID       &lt;chr&gt; "7590-VHVEG", "5575-GNVDE", "3668-QPYBK", "7795-CFOCW…
$ gender           &lt;chr&gt; "Female", "Male", "Male", "Male", "Female", "Female",…
$ SeniorCitizen    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Partner          &lt;chr&gt; "Yes", "No", "No", "No", "No", "No", "No", "No", "Yes…
$ Dependents       &lt;chr&gt; "No", "No", "No", "No", "No", "No", "Yes", "No", "No"…
$ tenure           &lt;dbl&gt; 1, 34, 2, 45, 2, 8, 22, 10, 28, 62, 13, 16, 58, 49, 2…
$ PhoneService     &lt;chr&gt; "No", "Yes", "Yes", "No", "Yes", "Yes", "Yes", "No", …
$ MultipleLines    &lt;chr&gt; "No phone service", "No", "No", "No phone service", "…
$ InternetService  &lt;chr&gt; "DSL", "DSL", "DSL", "DSL", "Fiber optic", "Fiber opt…
$ OnlineSecurity   &lt;chr&gt; "No", "Yes", "Yes", "Yes", "No", "No", "No", "Yes", "…
$ OnlineBackup     &lt;chr&gt; "Yes", "No", "Yes", "No", "No", "No", "Yes", "No", "N…
$ DeviceProtection &lt;chr&gt; "No", "Yes", "No", "Yes", "No", "Yes", "No", "No", "Y…
$ TechSupport      &lt;chr&gt; "No", "No", "No", "Yes", "No", "No", "No", "No", "Yes…
$ StreamingTV      &lt;chr&gt; "No", "No", "No", "No", "No", "Yes", "Yes", "No", "Ye…
$ StreamingMovies  &lt;chr&gt; "No", "No", "No", "No", "No", "Yes", "No", "No", "Yes…
$ Contract         &lt;chr&gt; "Month-to-month", "One year", "Month-to-month", "One …
$ PaperlessBilling &lt;chr&gt; "Yes", "No", "Yes", "No", "Yes", "Yes", "Yes", "No", …
$ PaymentMethod    &lt;chr&gt; "Electronic check", "Mailed check", "Mailed check", "…
$ MonthlyCharges   &lt;dbl&gt; 29.85, 56.95, 53.85, 42.30, 70.70, 99.65, 89.10, 29.7…
$ TotalCharges     &lt;dbl&gt; 29.85, 1889.50, 108.15, 1840.75, 151.65, 820.50, 1949…
$ Churn            &lt;chr&gt; "No", "No", "Yes", "No", "Yes", "Yes", "No", "No", "Y…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  customerID           gender          SeniorCitizen      Partner         
 Length:7032        Length:7032        Min.   :0.0000   Length:7032       
 Class :character   Class :character   1st Qu.:0.0000   Class :character  
 Mode  :character   Mode  :character   Median :0.0000   Mode  :character  
                                       Mean   :0.1624                     
                                       3rd Qu.:0.0000                     
                                       Max.   :1.0000                     
  Dependents            tenure      PhoneService       MultipleLines     
 Length:7032        Min.   : 1.00   Length:7032        Length:7032       
 Class :character   1st Qu.: 9.00   Class :character   Class :character  
 Mode  :character   Median :29.00   Mode  :character   Mode  :character  
                    Mean   :32.42                                        
                    3rd Qu.:55.00                                        
                    Max.   :72.00                                        
 InternetService    OnlineSecurity     OnlineBackup       DeviceProtection  
 Length:7032        Length:7032        Length:7032        Length:7032       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 TechSupport        StreamingTV        StreamingMovies      Contract        
 Length:7032        Length:7032        Length:7032        Length:7032       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 PaperlessBilling   PaymentMethod      MonthlyCharges    TotalCharges   
 Length:7032        Length:7032        Min.   : 18.25   Min.   :  18.8  
 Class :character   Class :character   1st Qu.: 35.59   1st Qu.: 401.4  
 Mode  :character   Mode  :character   Median : 70.35   Median :1397.5  
                                       Mean   : 64.80   Mean   :2283.3  
                                       3rd Qu.: 89.86   3rd Qu.:3794.7  
                                       Max.   :118.75   Max.   :8684.8  
    Churn          
 Length:7032       
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
</section>
<section id="outcome-variable" class="level2">
<h2 class="anchored" data-anchor-id="outcome-variable">Outcome Variable</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  No  Yes 
5163 1869 </code></pre>
</div>
</div>
<p>There are many more observations for customers who did not churn, which may make any model biased towards predicting no churn.</p>
</section>
<section id="character-variables" class="level2">
<h2 class="anchored" data-anchor-id="character-variables">Character Variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select character variables</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(churn)[<span class="fu">map_lgl</span>(churn, is.character)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "customerID"       "gender"           "Partner"          "Dependents"      
 [5] "PhoneService"     "MultipleLines"    "InternetService"  "OnlineSecurity"  
 [9] "OnlineBackup"     "DeviceProtection" "TechSupport"      "StreamingTV"     
[13] "StreamingMovies"  "Contract"         "PaperlessBilling" "PaymentMethod"   
[17] "Churn"           </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of character variables</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>char_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gender"</span>,<span class="st">"Partner"</span>,<span class="st">"Dependents"</span>,<span class="st">"PhoneService"</span>,<span class="st">"MultipleLines"</span>,<span class="st">"InternetService"</span>,<span class="st">"OnlineSecurity"</span>,<span class="st">"OnlineBackup"</span>,<span class="st">"DeviceProtection"</span>,<span class="st">"TechSupport"</span>,<span class="st">"StreamingTV"</span>,<span class="st">"StreamingMovies"</span>,<span class="st">"Contract"</span>,<span class="st">"PaperlessBilling"</span>,<span class="st">"PaymentMethod"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="category-counts" class="level3">
<h3 class="anchored" data-anchor-id="category-counts">Category Counts</h3>
<p>This section checks to see if there are any categories with very few observations for each of the categorical variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> char_vars) {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(var)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(churn[[var]]))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gender"

Female   Male 
  3483   3549 
[1] "Partner"

  No  Yes 
3639 3393 
[1] "Dependents"

  No  Yes 
4933 2099 
[1] "PhoneService"

  No  Yes 
 680 6352 
[1] "MultipleLines"

              No No phone service              Yes 
            3385              680             2967 
[1] "InternetService"

        DSL Fiber optic          No 
       2416        3096        1520 
[1] "OnlineSecurity"

                 No No internet service                 Yes 
               3497                1520                2015 
[1] "OnlineBackup"

                 No No internet service                 Yes 
               3087                1520                2425 
[1] "DeviceProtection"

                 No No internet service                 Yes 
               3094                1520                2418 
[1] "TechSupport"

                 No No internet service                 Yes 
               3472                1520                2040 
[1] "StreamingTV"

                 No No internet service                 Yes 
               2809                1520                2703 
[1] "StreamingMovies"

                 No No internet service                 Yes 
               2781                1520                2731 
[1] "Contract"

Month-to-month       One year       Two year 
          3875           1472           1685 
[1] "PaperlessBilling"

  No  Yes 
2864 4168 
[1] "PaymentMethod"

Bank transfer (automatic)   Credit card (automatic)          Electronic check 
                     1542                      1521                      2365 
             Mailed check 
                     1604 </code></pre>
</div>
</div>
<p>While there are some variables that have an imbalance of counts for each category, for the most part, every categorical variable has enough observations with in each category.</p>
</section>
<section id="chi-square-test-bar-plots" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-test-bar-plots">Chi Square Test Bar Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>gender,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
           No  Yes
  Female 2544  939
  Male   2619  930</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>gender,churn<span class="sc">$</span>Churn)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(churn$gender, churn$Churn)
X-squared = 0.47545, df = 1, p-value = 0.4905</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(gender), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by Gender"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/Gender-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>SeniorCitizen,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
      No  Yes
  0 4497 1393
  1  666  476</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>SeniorCitizen,churn<span class="sc">$</span>Churn)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(churn$SeniorCitizen, churn$Churn)
X-squared = 158.44, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(SeniorCitizen), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by SeniorCitizen Status"</span>, <span class="at">x =</span> <span class="st">"SeniorCitizen"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/SeniorCitizen-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>Partner,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
        No  Yes
  No  2439 1200
  Yes 2724  669</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>Partner,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(churn$Partner, churn$Churn)
X-squared = 157.5, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Partner), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by Partner Status"</span>, <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/Partner-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>Dependents,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
        No  Yes
  No  3390 1543
  Yes 1773  326</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>Dependents,churn<span class="sc">$</span>Churn)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(churn$Dependents, churn$Churn)
X-squared = 186.32, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Dependents), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by Dependents"</span>, <span class="at">x =</span> <span class="st">"Dependents"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/Dependents-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>PhoneService,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
        No  Yes
  No   510  170
  Yes 4653 1699</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>PhoneService,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(churn$PhoneService, churn$Churn)
X-squared = 0.87373, df = 1, p-value = 0.3499</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(PhoneService), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by PhoneService"</span>, <span class="at">x =</span> <span class="st">"PhoneService"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/PhoneService-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>MultipleLines,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  
                     No  Yes
  No               2536  849
  No phone service  510  170
  Yes              2117  850</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>MultipleLines,churn<span class="sc">$</span>Churn)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$MultipleLines, churn$Churn)
X-squared = 11.272, df = 2, p-value = 0.003568</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(MultipleLines), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by MultipleLines"</span>, <span class="at">x =</span> <span class="st">"MultipleLines"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/MultipleLines-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>InternetService,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
                No  Yes
  DSL         1957  459
  Fiber optic 1799 1297
  No          1407  113</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>InternetService,churn<span class="sc">$</span>Churn)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$InternetService, churn$Churn)
X-squared = 728.7, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(InternetService), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by InternetService"</span>, <span class="at">x =</span> <span class="st">"InternetService"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/InternetService-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>OnlineSecurity,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                        No  Yes
  No                  2036 1461
  No internet service 1407  113
  Yes                 1720  295</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>OnlineSecurity,churn<span class="sc">$</span>Churn)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$OnlineSecurity, churn$Churn)
X-squared = 846.68, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(OnlineSecurity), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by OnlineSecurity"</span>, <span class="at">x =</span> <span class="st">"OnlineSecurity"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/OnlineSecurity-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>OnlineBackup,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                        No  Yes
  No                  1854 1233
  No internet service 1407  113
  Yes                 1902  523</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>OnlineBackup,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$OnlineBackup, churn$Churn)
X-squared = 599.18, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(OnlineBackup), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by OnlineBackup"</span>, <span class="at">x =</span> <span class="st">"OnlineBackup"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/OnlineBackup-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>DeviceProtection,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                        No  Yes
  No                  1883 1211
  No internet service 1407  113
  Yes                 1873  545</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>DeviceProtection,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$DeviceProtection, churn$Churn)
X-squared = 555.88, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(DeviceProtection), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by DeviceProtection"</span>, <span class="at">x =</span> <span class="st">"DeviceProtection"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/DeviceProtection-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>TechSupport,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                        No  Yes
  No                  2026 1446
  No internet service 1407  113
  Yes                 1730  310</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>TechSupport,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$TechSupport, churn$Churn)
X-squared = 824.93, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(TechSupport), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by TechSupport"</span>, <span class="at">x =</span> <span class="st">"TechSupport"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/TechSupport-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>StreamingTV,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                        No  Yes
  No                  1867  942
  No internet service 1407  113
  Yes                 1889  814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>StreamingTV,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$StreamingTV, churn$Churn)
X-squared = 372.46, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(StreamingTV), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by StreamingTV"</span>, <span class="at">x =</span> <span class="st">"StreamingTV"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/StreamingTV-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>StreamingMovies,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                        No  Yes
  No                  1843  938
  No internet service 1407  113
  Yes                 1913  818</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>StreamingMovies,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$StreamingMovies, churn$Churn)
X-squared = 374.27, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(StreamingMovies), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by StreamingMovies"</span>, <span class="at">x =</span> <span class="st">"StreamingMovies"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/StreamingMovies-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>Contract,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                
                   No  Yes
  Month-to-month 2220 1655
  One year       1306  166
  Two year       1637   48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>Contract,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$Contract, churn$Churn)
X-squared = 1179.5, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Contract), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by Contract"</span>, <span class="at">x =</span> <span class="st">"Contract"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/Contract-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>PaperlessBilling,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
        No  Yes
  No  2395  469
  Yes 2768 1400</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>PaperlessBilling,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(churn$PaperlessBilling, churn$Churn)
X-squared = 256.87, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(PaperlessBilling), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by PaperlessBilling"</span>, <span class="at">x =</span> <span class="st">"PaperlessBilling"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/PaperlessBilling-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(churn<span class="sc">$</span>PaymentMethod,churn<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           
                              No  Yes
  Bank transfer (automatic) 1284  258
  Credit card (automatic)   1289  232
  Electronic check          1294 1071
  Mailed check              1296  308</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(churn<span class="sc">$</span>PaymentMethod,churn<span class="sc">$</span>Churn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(churn$PaymentMethod, churn$Churn)
X-squared = 645.43, df = 3, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(PaymentMethod), <span class="at">fill =</span> <span class="fu">factor</span>(Churn))) <span class="sc">+</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Churn Rate by PaymentMethod"</span>, <span class="at">x =</span> <span class="st">"PaymentMethod"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/PaymentMethod-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="numeric-variables" class="level2">
<h2 class="anchored" data-anchor-id="numeric-variables">Numeric Variables</h2>
<section id="boxplots" class="level3">
<h3 class="anchored" data-anchor-id="boxplots">BoxPlots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(MonthlyCharges<span class="sc">~</span>Churn, <span class="at">data =</span> churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/MonthlyCharges-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(tenure<span class="sc">~</span>Churn, <span class="at">data =</span> churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/tenure-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(TotalCharges<span class="sc">~</span>Churn, <span class="at">data =</span> churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/TotalCharges-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distributions" class="level3">
<h3 class="anchored" data-anchor-id="distributions">Distributions</h3>
<p>MonthlyCharges, tenure, and TotalCharges</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(churn<span class="sc">$</span>MonthlyCharges)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(churn<span class="sc">$</span>tenure)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(churn<span class="sc">$</span>TotalCharges)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(churn<span class="sc">$</span>MonthlyCharges))</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(churn<span class="sc">$</span>tenure))</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(churn<span class="sc">$</span>TotalCharges))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/numeric distributions-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The numeric predictors are not normally distributed which may lead to the model having greater predictor power given certain values of predictors rather than others.</p>
</section>
</section>
</section>
<section id="model-assumptions" class="level1">
<h1>Model Assumptions</h1>
<section id="significant-predictors" class="level2">
<h2 class="anchored" data-anchor-id="significant-predictors">Significant predictors</h2>
<p>Section A.1.3.2 shows the outcome of chi-square tests to assess the relationship between each variable and the outcome variable, Churn. These tests determined that the following variables are significantly related to Churn: SeniorCitizen, Partner, Dependents, MultipleLines, InternetService, OnlineSecurity, OnlineBackup, DeviceProtection, TechSupport, StreamingTV, StreamingMovies, Contract, PaperlessBilling and PaymentMethod. And all numeric variables, Tenure, MonthlyCharges, and TotalCharges have significantly different means for Churn status.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit an initial model to further determine variable significance.</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>churn<span class="sc">$</span>Churn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(churn<span class="sc">$</span>Churn <span class="sc">==</span> <span class="st">'Yes'</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>churn.fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(Churn<span class="sc">~</span>.<span class="sc">-</span>customerID,<span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>),<span class="at">data =</span> churn)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(churn.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Churn ~ . - customerID, family = binomial(link = "logit"), 
    data = churn)

Coefficients: (7 not defined because of singularities)
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           1.165e+00  8.151e-01   1.430  0.15284    
genderMale                           -2.183e-02  6.480e-02  -0.337  0.73619    
SeniorCitizen                         2.168e-01  8.453e-02   2.564  0.01033 *  
PartnerYes                           -3.840e-04  7.783e-02  -0.005  0.99606    
DependentsYes                        -1.485e-01  8.973e-02  -1.655  0.09796 .  
tenure                               -6.059e-02  6.236e-03  -9.716  &lt; 2e-16 ***
PhoneServiceYes                       1.715e-01  6.487e-01   0.264  0.79153    
MultipleLinesNo phone service                NA         NA      NA       NA    
MultipleLinesYes                      4.484e-01  1.773e-01   2.530  0.01142 *  
InternetServiceFiber optic            1.747e+00  7.981e-01   2.190  0.02855 *  
InternetServiceNo                    -1.786e+00  8.073e-01  -2.213  0.02691 *  
OnlineSecurityNo internet service            NA         NA      NA       NA    
OnlineSecurityYes                    -2.054e-01  1.787e-01  -1.150  0.25031    
OnlineBackupNo internet service              NA         NA      NA       NA    
OnlineBackupYes                       2.604e-02  1.754e-01   0.148  0.88197    
DeviceProtectionNo internet service          NA         NA      NA       NA    
DeviceProtectionYes                   1.474e-01  1.764e-01   0.836  0.40339    
TechSupportNo internet service               NA         NA      NA       NA    
TechSupportYes                       -1.805e-01  1.806e-01  -0.999  0.31759    
StreamingTVNo internet service               NA         NA      NA       NA    
StreamingTVYes                        5.905e-01  3.263e-01   1.810  0.07035 .  
StreamingMoviesNo internet service           NA         NA      NA       NA    
StreamingMoviesYes                    5.993e-01  3.267e-01   1.834  0.06658 .  
ContractOne year                     -6.608e-01  1.076e-01  -6.142 8.15e-10 ***
ContractTwo year                     -1.357e+00  1.764e-01  -7.691 1.46e-14 ***
PaperlessBillingYes                   3.424e-01  7.450e-02   4.596 4.31e-06 ***
PaymentMethodCredit card (automatic) -8.779e-02  1.141e-01  -0.770  0.44156    
PaymentMethodElectronic check         3.045e-01  9.450e-02   3.222  0.00127 ** 
PaymentMethodMailed check            -5.759e-02  1.149e-01  -0.501  0.61627    
MonthlyCharges                       -4.034e-02  3.176e-02  -1.270  0.20392    
TotalCharges                          3.289e-04  7.063e-05   4.657 3.20e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8143.4  on 7031  degrees of freedom
Residual deviance: 5826.3  on 7008  degrees of freedom
AIC: 5874.3

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(coefplot)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefplot</span>(churn.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/churn.fit-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This model indicates that considering all variables available, the following variables are significantly related to Churn.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>churn.fit.reduced <span class="ot">&lt;-</span> <span class="fu">glm</span>(Churn<span class="sc">~</span>SeniorCitizen<span class="sc">+</span>tenure<span class="sc">+</span>MultipleLines<span class="sc">+</span>InternetService<span class="sc">+</span>Contract<span class="sc">+</span>PaperlessBilling<span class="sc">+</span>PaymentMethod<span class="sc">+</span>TotalCharges,<span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>),<span class="at">data =</span> churn)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(churn.fit.reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Churn ~ SeniorCitizen + tenure + MultipleLines + 
    InternetService + Contract + PaperlessBilling + PaymentMethod + 
    TotalCharges, family = binomial(link = "logit"), data = churn)

Coefficients:
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          -0.7524686  0.1216481  -6.186 6.19e-10 ***
SeniorCitizen                         0.2838042  0.0820511   3.459 0.000542 ***
tenure                               -0.0623101  0.0059172 -10.530  &lt; 2e-16 ***
MultipleLinesNo phone service         0.7163172  0.1296922   5.523 3.33e-08 ***
MultipleLinesYes                      0.2794728  0.0788261   3.545 0.000392 ***
InternetServiceFiber optic            0.9105034  0.0951849   9.566  &lt; 2e-16 ***
InternetServiceNo                    -0.5347664  0.1307872  -4.089 4.34e-05 ***
ContractOne year                     -0.7177526  0.1051426  -6.826 8.70e-12 ***
ContractTwo year                     -1.5309937  0.1736988  -8.814  &lt; 2e-16 ***
PaperlessBillingYes                   0.3843680  0.0734646   5.232 1.68e-07 ***
PaymentMethodCredit card (automatic) -0.0969663  0.1131124  -0.857 0.391303    
PaymentMethodElectronic check         0.3697148  0.0934143   3.958 7.56e-05 ***
PaymentMethodMailed check            -0.0803387  0.1135281  -0.708 0.479160    
TotalCharges                          0.0003168  0.0000630   5.029 4.94e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8143.4  on 7031  degrees of freedom
Residual deviance: 5899.8  on 7018  degrees of freedom
AIC: 5927.8

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>But we will use variable selection to determine the ultimate best model.</p>
</section>
<section id="multicollinearity" class="level2">
<h2 class="anchored" data-anchor-id="multicollinearity">Multicollinearity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Xs are independent (uncorrelated)</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cond.index</span>(churn.fit, <span class="at">data=</span>churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.000000e+00 1.361638e+00 2.737057e+00 3.255377e+00 3.637219e+00
 [6] 3.720449e+00 3.993979e+00 4.232393e+00 4.362516e+00 4.723229e+00
[11] 5.126693e+00 5.241772e+00 5.355070e+00 5.635948e+00 5.751611e+00
[16] 6.355325e+00 6.648467e+00 6.716715e+00 6.907980e+00 7.422290e+00
[21] 9.573179e+00 1.117690e+01 2.289433e+01 2.812095e+02 8.631410e+07
[26] 1.021002e+08 1.021002e+08 1.021002e+08 1.021002e+08 1.021002e+08
[31] 1.021002e+08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cond.index</span>(churn.fit.reduced, <span class="at">data=</span>churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1.000000  1.851448  2.188398  2.371296  2.496958  2.842187  3.032654
 [8]  3.195287  4.156824  4.535447  5.204044  6.324844  9.710559 13.676272</code></pre>
</div>
</div>
<p>The CI for the full model is very high at 102,100,200. The reduced model with only variables signficant the 95 percent level has a much lower CI.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(churn.fit.reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      GVIF Df GVIF^(1/(2*Df))
SeniorCitizen     1.085653  1        1.041947
tenure           14.365387  1        3.790170
MultipleLines     1.903615  2        1.174613
InternetService   2.350769  2        1.238233
Contract          1.515189  2        1.109473
PaperlessBilling  1.113868  1        1.055399
PaymentMethod     1.340114  3        1.050002
TotalCharges     16.454504  1        4.056415</code></pre>
</div>
</div>
<p>None of the variance inflation factors for the variables in the reduced model exceeds the threshold of 10.</p>
</section>
<section id="outliers-variable-distributions" class="level2">
<h2 class="anchored" data-anchor-id="outliers-variable-distributions">Outliers &amp; Variable Distributions</h2>
<p>Severe outliers do not appear to be a problem for any of the variables, but all variables do have either a non-normal, skewed, or slightly unbalanced distributions. Therefore, this dataset is likely to produce models with high variation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(churn.fit.reduced, <span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/outlier plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(churn.fit.reduced, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/outlier plots-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>churn[<span class="fu">c</span>(<span class="dv">269</span>,<span class="dv">4266</span>,<span class="dv">4812</span>),<span class="fu">c</span>(<span class="st">"SeniorCitizen"</span>,<span class="st">"tenure"</span>,<span class="st">"MultipleLines"</span>,<span class="st">"InternetService"</span>,<span class="st">"Contract"</span>,<span class="st">"PaperlessBilling"</span>,<span class="st">"PaymentMethod"</span>,<span class="st">"TotalCharges"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  SeniorCitizen tenure MultipleLines InternetService Contract PaperlessBilling
          &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;           
1             0     59 No            No              Two year No              
2             0     56 Yes           No              Two year Yes             
3             0     53 No            No              Two year No              
# ℹ 2 more variables: PaymentMethod &lt;chr&gt;, TotalCharges &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(churn[,<span class="fu">c</span>(<span class="st">"SeniorCitizen"</span>,<span class="st">"tenure"</span>,<span class="st">"MultipleLines"</span>,<span class="st">"InternetService"</span>,<span class="st">"Contract"</span>,<span class="st">"PaperlessBilling"</span>,<span class="st">"PaymentMethod"</span>,<span class="st">"TotalCharges"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> SeniorCitizen        tenure      MultipleLines      InternetService   
 Min.   :0.0000   Min.   : 1.00   Length:7032        Length:7032       
 1st Qu.:0.0000   1st Qu.: 9.00   Class :character   Class :character  
 Median :0.0000   Median :29.00   Mode  :character   Mode  :character  
 Mean   :0.1624   Mean   :32.42                                        
 3rd Qu.:0.0000   3rd Qu.:55.00                                        
 Max.   :1.0000   Max.   :72.00                                        
   Contract         PaperlessBilling   PaymentMethod       TotalCharges   
 Length:7032        Length:7032        Length:7032        Min.   :  18.8  
 Class :character   Class :character   Class :character   1st Qu.: 401.4  
 Mode  :character   Mode  :character   Mode  :character   Median :1397.5  
                                                          Mean   :2283.3  
                                                          3rd Qu.:3794.7  
                                                          Max.   :8684.8  </code></pre>
</div>
</div>
<p>These three customers, c(269,4266,4812), are identified as potential influential observations. This may be because they have longer than average tenure as customers, all close to the 75th percentile of tenure length among the entire dataset.</p>
</section>
<section id="linearity" class="level2">
<h2 class="anchored" data-anchor-id="linearity">Linearity</h2>
<p>Relationship between log-odds of Churn and numeric predictors. [Linearity of numeric predictors for logit models] (<a href="https://stats.stackexchange.com/questions/169348/how-should-i-check-the-assumption-of-linearity-to-the-logit-for-the-continuous-i" class="uri">https://stats.stackexchange.com/questions/169348/how-should-i-check-the-assumption-of-linearity-to-the-logit-for-the-continuous-i</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(churn[,<span class="fu">c</span>(<span class="st">'tenure'</span>,<span class="st">'TotalCharges'</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     tenure       TotalCharges   
 Min.   : 1.00   Min.   :  18.8  
 1st Qu.: 9.00   1st Qu.: 401.4  
 Median :29.00   Median :1397.5  
 Mean   :32.42   Mean   :2283.3  
 3rd Qu.:55.00   3rd Qu.:3794.7  
 Max.   :72.00   Max.   :8684.8  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>churn.fit.num <span class="ot">&lt;-</span> <span class="fu">glm</span>(Churn<span class="sc">~</span>tenure<span class="sc">+</span>TotalCharges,<span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>), <span class="at">data =</span> churn)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>log.odds <span class="ot">&lt;-</span> <span class="fu">predict</span>(churn.fit.num, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(churn<span class="sc">$</span>tenure,log.odds)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(churn<span class="sc">$</span>TotalCharges,log.odds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/churn.fit.num-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">&lt;-</span> <span class="fu">exp</span>(log.odds)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">&lt;-</span> odds<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>odds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="variable-selection" class="level1">
<h1>Variable Selection</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>churn.null <span class="ot">&lt;-</span> <span class="fu">glm</span>(Churn<span class="sc">~</span><span class="dv">1</span>,<span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>),<span class="at">data =</span> churn)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Because there are so many variables, we can afford to be restrictive on variable selection</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="at">lower.tail=</span>F)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>churn.stepwise <span class="ot">&lt;-</span> <span class="fu">step</span>(churn.fit,</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower =</span> churn.null,<span class="at">upper =</span> churn.fit),</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction=</span><span class="st">"both"</span>,<span class="at">test=</span><span class="st">"F"</span>,</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=5985.51
Churn ~ (customerID + gender + SeniorCitizen + Partner + Dependents + 
    tenure + PhoneService + MultipleLines + InternetService + 
    OnlineSecurity + OnlineBackup + DeviceProtection + TechSupport + 
    StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
    PaymentMethod + MonthlyCharges + TotalCharges) - customerID


Step:  AIC=5985.51
Churn ~ gender + SeniorCitizen + Partner + Dependents + tenure + 
    MultipleLines + InternetService + OnlineSecurity + OnlineBackup + 
    DeviceProtection + TechSupport + StreamingTV + StreamingMovies + 
    Contract + PaperlessBilling + PaymentMethod + MonthlyCharges + 
    TotalCharges

                   Df Deviance    AIC  F value    Pr(&gt;F)    
- Partner           1   5826.3 5978.9   0.0000  0.995683    
- OnlineBackup      1   5826.3 5978.9   0.0265  0.870655    
- gender            1   5826.4 5979.0   0.1365  0.711779    
- DeviceProtection  1   5827.0 5979.6   0.8400  0.359434    
- TechSupport       1   5827.3 5979.9   1.2023  0.272899    
- OnlineSecurity    1   5827.6 5980.2   1.5908  0.207249    
- MonthlyCharges    1   5827.9 5980.5   1.9425  0.163445    
- Dependents        1   5829.0 5981.6   3.3074  0.069011 .  
- StreamingTV       1   5829.6 5982.2   3.9445  0.047063 *  
- StreamingMovies   1   5829.6 5982.2   4.0537  0.044114 *  
- InternetService   1   5831.1 5983.7   5.7775  0.016258 *  
- SeniorCitizen     1   5832.8 5985.4   7.8961  0.004968 ** 
&lt;none&gt;                  5826.3 5985.5                       
- PaymentMethod     3   5852.5 5991.8  10.4974 6.921e-07 ***
- MultipleLines     2   5846.8 5992.7  12.3269 4.528e-06 ***
- PaperlessBilling  1   5847.5 6000.1  25.5466 4.428e-07 ***
- TotalCharges      1   5849.1 6001.7  27.4197 1.685e-07 ***
- Contract          2   5908.5 6054.5  49.4708 &lt; 2.2e-16 ***
- tenure            1   5937.9 6090.5 134.2485 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=5978.88
Churn ~ gender + SeniorCitizen + Dependents + tenure + MultipleLines + 
    InternetService + OnlineSecurity + OnlineBackup + DeviceProtection + 
    TechSupport + StreamingTV + StreamingMovies + Contract + 
    PaperlessBilling + PaymentMethod + MonthlyCharges + TotalCharges

                   Df Deviance    AIC  F value    Pr(&gt;F)    
- OnlineBackup      1   5826.3 5972.3   0.0265  0.870693    
- gender            1   5826.4 5972.4   0.1366  0.711670    
- DeviceProtection  1   5827.0 5972.9   0.8407  0.359238    
- TechSupport       1   5827.3 5973.2   1.2030  0.272762    
- OnlineSecurity    1   5827.6 5973.6   1.5924  0.207020    
- MonthlyCharges    1   5827.9 5973.9   1.9433  0.163357    
- StreamingTV       1   5829.6 5975.5   3.9468  0.046999 *  
- Dependents        1   5829.6 5975.6   4.0319  0.044685 *  
- StreamingMovies   1   5829.6 5975.6   4.0556  0.044062 *  
- InternetService   1   5831.1 5977.0   5.7810  0.016226 *  
&lt;none&gt;                  5826.3 5978.9                       
- SeniorCitizen     1   5832.9 5978.9   7.9914  0.004713 ** 
- PaymentMethod     3   5852.5 5985.2  10.5053 6.842e-07 ***
+ Partner           1   5826.3 5985.5   0.0000  0.995683    
- MultipleLines     2   5846.8 5986.1  12.3318 4.506e-06 ***
- PaperlessBilling  1   5847.5 5993.5  25.5506 4.419e-07 ***
- TotalCharges      1   5849.1 5995.0  27.4238 1.682e-07 ***
- Contract          2   5908.5 6047.9  49.4783 &lt; 2.2e-16 ***
- tenure            1   5938.7 6084.7 135.2905 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=5972.26
Churn ~ gender + SeniorCitizen + Dependents + tenure + MultipleLines + 
    InternetService + OnlineSecurity + DeviceProtection + TechSupport + 
    StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
    PaymentMethod + MonthlyCharges + TotalCharges

                   Df Deviance    AIC  F value    Pr(&gt;F)    
- gender            1   5826.4 5965.7   0.1400 0.7082855    
- DeviceProtection  1   5827.7 5967.1   1.7283 0.1886711    
- TechSupport       1   5829.6 5968.9   3.9831 0.0459966 *  
- Dependents        1   5829.6 5969.0   4.0233 0.0449149 *  
- OnlineSecurity    1   5830.6 5969.9   5.1377 0.0234419 *  
- MonthlyCharges    1   5832.9 5972.2   7.9598 0.0047963 ** 
&lt;none&gt;                  5826.3 5972.3                       
- SeniorCitizen     1   5832.9 5972.3   7.9841 0.0047323 ** 
- StreamingTV       1   5838.0 5977.4  14.1423 0.0001709 ***
- StreamingMovies   1   5838.6 5977.9  14.7576 0.0001233 ***
- PaymentMethod     3   5852.5 5978.6  10.5053 6.842e-07 ***
+ OnlineBackup      1   5826.3 5978.9   0.0265 0.8706934    
+ Partner           1   5826.3 5978.9   0.0000 0.9975429    
- MultipleLines     2   5847.8 5980.5  12.9562 2.419e-06 ***
- InternetService   1   5847.3 5986.7  25.3094 5.005e-07 ***
- PaperlessBilling  1   5847.6 5986.9  25.6292 4.243e-07 ***
- TotalCharges      1   5849.2 5988.5  27.5011 1.616e-07 ***
- Contract          2   5908.6 6041.2  49.4844 &lt; 2.2e-16 ***
- tenure            1   5938.7 6078.1 135.2829 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=5965.74
Churn ~ SeniorCitizen + Dependents + tenure + MultipleLines + 
    InternetService + OnlineSecurity + DeviceProtection + TechSupport + 
    StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
    PaymentMethod + MonthlyCharges + TotalCharges

                   Df Deviance    AIC  F value    Pr(&gt;F)    
- DeviceProtection  1   5827.8 5960.5   1.7216 0.1895293    
- TechSupport       1   5829.7 5962.4   3.9890 0.0458366 *  
- Dependents        1   5829.8 5962.5   4.0325 0.0446692 *  
- OnlineSecurity    1   5830.7 5963.4   5.1167 0.0237271 *  
- MonthlyCharges    1   5833.0 5965.7   7.9394 0.0048506 ** 
&lt;none&gt;                  5826.4 5965.7                       
- SeniorCitizen     1   5833.0 5965.7   7.9875 0.0047234 ** 
- StreamingTV       1   5838.1 5970.8  14.1253 0.0001724 ***
- StreamingMovies   1   5838.7 5971.4  14.7487 0.0001239 ***
- PaymentMethod     3   5852.6 5972.0  10.5092 6.804e-07 ***
+ gender            1   5826.3 5972.3   0.1400 0.7082855    
+ OnlineBackup      1   5826.4 5972.4   0.0299 0.8628053    
+ Partner           1   5826.4 5972.4   0.0001 0.9932433    
- MultipleLines     2   5847.9 5974.0  12.9550 2.422e-06 ***
- InternetService   1   5847.4 5980.1  25.2888 5.058e-07 ***
- PaperlessBilling  1   5847.7 5980.4  25.6681 4.158e-07 ***
- TotalCharges      1   5849.3 5982.0  27.4915 1.624e-07 ***
- Contract          2   5908.6 6034.7  49.4587 &lt; 2.2e-16 ***
- tenure            1   5938.9 6071.6 135.3674 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=5960.54
Churn ~ SeniorCitizen + Dependents + tenure + MultipleLines + 
    InternetService + OnlineSecurity + TechSupport + StreamingTV + 
    StreamingMovies + Contract + PaperlessBilling + PaymentMethod + 
    MonthlyCharges + TotalCharges

                   Df Deviance    AIC  F value    Pr(&gt;F)    
- Dependents        1   5831.2 5957.3   4.0895 0.0431874 *  
- MonthlyCharges    1   5833.4 5959.5   6.7402 0.0094459 ** 
- TechSupport       1   5834.1 5960.1   7.4812 0.0062503 ** 
&lt;none&gt;                  5827.8 5960.5                       
- SeniorCitizen     1   5834.5 5960.6   7.9961 0.0047011 ** 
- OnlineSecurity    1   5836.0 5962.1   9.8742 0.0016831 ** 
- StreamingTV       1   5838.7 5964.8  13.1090 0.0002960 ***
- StreamingMovies   1   5839.3 5965.4  13.8304 0.0002016 ***
+ DeviceProtection  1   5826.4 5965.7   1.7216 0.1895293    
+ OnlineBackup      1   5827.1 5966.4   0.8985 0.3432191    
- PaymentMethod     3   5853.8 5966.6  10.4160 7.788e-07 ***
+ gender            1   5827.7 5967.1   0.1331 0.7152622    
+ Partner           1   5827.8 5967.2   0.0014 0.9697636    
- MultipleLines     2   5848.2 5967.6  12.2431 4.922e-06 ***
- PaperlessBilling  1   5848.9 5975.0  25.3844 4.815e-07 ***
- TotalCharges      1   5850.6 5976.6  27.3620 1.736e-07 ***
- InternetService   1   5852.5 5978.6  29.6994 5.217e-08 ***
- Contract          2   5909.0 6028.4  48.8299 &lt; 2.2e-16 ***
- tenure            1   5940.6 6066.6 135.6185 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=5957.3
Churn ~ SeniorCitizen + tenure + MultipleLines + InternetService + 
    OnlineSecurity + TechSupport + StreamingTV + StreamingMovies + 
    Contract + PaperlessBilling + PaymentMethod + MonthlyCharges + 
    TotalCharges

                   Df Deviance    AIC  F value    Pr(&gt;F)    
- MonthlyCharges    1   5837.0 5956.4   6.9393 0.0084506 ** 
- TechSupport       1   5837.4 5956.9   7.4476 0.0063678 ** 
&lt;none&gt;                  5831.2 5957.3                       
- OnlineSecurity    1   5839.6 5959.1  10.0837 0.0015023 ** 
- SeniorCitizen     1   5839.7 5959.1  10.1914 0.0014172 ** 
+ Dependents        1   5827.8 5960.5   4.0895 0.0431874 *  
- StreamingTV       1   5842.1 5961.6  13.1150 0.0002950 ***
- StreamingMovies   1   5843.0 5962.4  14.1473 0.0001704 ***
+ DeviceProtection  1   5829.8 5962.5   1.7783 0.1824064    
+ OnlineBackup      1   5830.4 5963.1   0.9683 0.3251377    
+ Partner           1   5830.7 5963.4   0.6668 0.4141968    
- PaymentMethod     3   5857.6 5963.8  10.5743 6.191e-07 ***
+ gender            1   5831.1 5963.8   0.1414 0.7069131    
- MultipleLines     2   5851.8 5964.6  12.3686 4.343e-06 ***
- PaperlessBilling  1   5852.8 5972.2  25.9393 3.615e-07 ***
- TotalCharges      1   5854.7 5974.2  28.2693 1.088e-07 ***
- InternetService   1   5856.5 5975.9  30.3326 3.769e-08 ***
- Contract          2   5915.3 6028.1  50.5738 &lt; 2.2e-16 ***
- tenure            1   5946.8 6066.2 138.9546 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=5956.44
Churn ~ SeniorCitizen + tenure + MultipleLines + InternetService + 
    OnlineSecurity + TechSupport + StreamingTV + StreamingMovies + 
    Contract + PaperlessBilling + PaymentMethod + TotalCharges

                   Df Deviance    AIC  F value    Pr(&gt;F)    
- StreamingTV       1   5842.3 5955.1   6.3540  0.011734 *  
- StreamingMovies   1   5843.3 5956.1   7.5528  0.006007 ** 
&lt;none&gt;                  5837.0 5956.4                       
+ MonthlyCharges    1   5831.2 5957.3   6.9393  0.008451 ** 
+ OnlineBackup      1   5831.8 5957.9   6.2596  0.012375 *  
- SeniorCitizen     1   5845.4 5958.2  10.1244  0.001470 ** 
+ Dependents        1   5833.4 5959.5   4.2882  0.038415 *  
+ Partner           1   5836.4 5962.5   0.7297  0.393010    
+ DeviceProtection  1   5836.6 5962.6   0.5364  0.463953    
+ gender            1   5836.9 5963.0   0.1260  0.722642    
- PaymentMethod     3   5863.9 5963.4  10.7803 4.594e-07 ***
- TotalCharges      1   5856.5 5969.3  23.4663 1.298e-06 ***
- TechSupport       1   5857.6 5970.4  24.7227 6.777e-07 ***
- MultipleLines     2   5865.0 5971.2  16.8217 5.151e-08 ***
- PaperlessBilling  1   5858.6 5971.4  25.9429 3.608e-07 ***
- OnlineSecurity    1   5860.5 5973.3  28.2653 1.090e-07 ***
- InternetService   1   5898.6 6011.4  73.9815 &lt; 2.2e-16 ***
- Contract          2   5923.9 6030.0  52.1868 &lt; 2.2e-16 ***
- tenure            1   5948.3 6061.1 133.7254 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Step:  AIC=5955.09
Churn ~ SeniorCitizen + tenure + MultipleLines + InternetService + 
    OnlineSecurity + TechSupport + StreamingMovies + Contract + 
    PaperlessBilling + PaymentMethod + TotalCharges

                   Df Deviance    AIC  F value    Pr(&gt;F)    
&lt;none&gt;                  5842.3 5955.1                       
+ OnlineBackup      1   5836.8 5956.2   6.6031 0.0102009 *  
+ StreamingTV       1   5837.0 5956.4   6.3540 0.0117338 *  
- SeniorCitizen     1   5850.5 5956.7   9.9076 0.0016529 ** 
+ Dependents        1   5838.9 5958.4   4.0383 0.0445164 *  
- StreamingMovies   1   5852.4 5958.5  12.0852 0.0005113 ***
+ Partner           1   5841.8 5961.2   0.6241 0.4295579    
+ DeviceProtection  1   5842.1 5961.5   0.2881 0.5914718    
+ MonthlyCharges    1   5842.1 5961.6   0.1834 0.6685043    
+ gender            1   5842.2 5961.6   0.1335 0.7148187    
- PaymentMethod     3   5871.2 5964.1  11.5578 1.487e-07 ***
- TechSupport       1   5862.1 5968.3  23.7728 1.108e-06 ***
- MultipleLines     2   5871.9 5971.4  17.7594 2.026e-08 ***
- PaperlessBilling  1   5865.3 5971.5  27.6200 1.520e-07 ***
- OnlineSecurity    1   5867.1 5973.2  29.7671 5.038e-08 ***
- TotalCharges      1   5867.8 5974.0  30.6369 3.224e-08 ***
- InternetService   1   5904.1 6010.3  74.2505 &lt; 2.2e-16 ***
- Contract          2   5927.4 6026.9  51.0799 &lt; 2.2e-16 ***
- tenure            1   5964.8 6071.0 147.1280 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(churn.stepwise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Churn ~ SeniorCitizen + tenure + MultipleLines + 
    InternetService + OnlineSecurity + TechSupport + StreamingMovies + 
    Contract + PaperlessBilling + PaymentMethod + TotalCharges, 
    family = binomial(link = "logit"), data = churn)

Coefficients: (3 not defined because of singularities)
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          -5.483e-01  1.293e-01  -4.240 2.23e-05 ***
SeniorCitizen                         2.381e-01  8.279e-02   2.876 0.004025 ** 
tenure                               -6.192e-02  6.104e-03 -10.145  &lt; 2e-16 ***
MultipleLinesNo phone service         6.441e-01  1.322e-01   4.872 1.10e-06 ***
MultipleLinesYes                      2.515e-01  7.946e-02   3.165 0.001549 ** 
InternetServiceFiber optic            7.647e-01  9.796e-02   7.806 5.90e-15 ***
InternetServiceNo                    -7.530e-01  1.361e-01  -5.531 3.18e-08 ***
OnlineSecurityNo internet service            NA         NA      NA       NA    
OnlineSecurityYes                    -4.180e-01  8.449e-02  -4.947 7.53e-07 ***
TechSupportNo internet service               NA         NA      NA       NA    
TechSupportYes                       -3.789e-01  8.554e-02  -4.429 9.46e-06 ***
StreamingMoviesNo internet service           NA         NA      NA       NA    
StreamingMoviesYes                    2.490e-01  7.861e-02   3.168 0.001537 ** 
ContractOne year                     -6.650e-01  1.067e-01  -6.234 4.55e-10 ***
ContractTwo year                     -1.367e+00  1.757e-01  -7.781 7.20e-15 ***
PaperlessBillingYes                   3.546e-01  7.417e-02   4.781 1.74e-06 ***
PaymentMethodCredit card (automatic) -9.244e-02  1.139e-01  -0.812 0.416984    
PaymentMethodElectronic check         3.175e-01  9.423e-02   3.370 0.000752 ***
PaymentMethodMailed check            -6.107e-02  1.145e-01  -0.533 0.593821    
TotalCharges                          3.305e-04  6.723e-05   4.917 8.80e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8143.4  on 7031  degrees of freedom
Residual deviance: 5842.3  on 7015  degrees of freedom
AIC: 5876.3

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Variables selected:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>churn.stepwise<span class="sc">$</span>call</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>glm(formula = Churn ~ SeniorCitizen + tenure + MultipleLines + 
    InternetService + OnlineSecurity + TechSupport + StreamingMovies + 
    Contract + PaperlessBilling + PaymentMethod + TotalCharges, 
    family = binomial(link = "logit"), data = churn)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>churn.fit.reduced<span class="sc">$</span>call</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>glm(formula = Churn ~ SeniorCitizen + tenure + MultipleLines + 
    InternetService + Contract + PaperlessBilling + PaymentMethod + 
    TotalCharges, family = binomial(link = "logit"), data = churn)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove streaming movies</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>churn.stepwise<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> Churn <span class="sc">~</span> SeniorCitizen <span class="sc">+</span> tenure <span class="sc">+</span> MultipleLines <span class="sc">+</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    InternetService <span class="sc">+</span> OnlineSecurity <span class="sc">+</span> TechSupport <span class="sc">+</span> </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    Contract <span class="sc">+</span> PaperlessBilling <span class="sc">+</span> PaymentMethod <span class="sc">+</span> TotalCharges, </span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> churn)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove streaming movies, TechSupport</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>churn.stepwise<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> Churn <span class="sc">~</span> SeniorCitizen <span class="sc">+</span> tenure <span class="sc">+</span> MultipleLines <span class="sc">+</span> </span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    InternetService <span class="sc">+</span> OnlineSecurity <span class="sc">+</span> </span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    Contract <span class="sc">+</span> PaperlessBilling <span class="sc">+</span> PaymentMethod <span class="sc">+</span> TotalCharges, </span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> churn)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(churn.fit.reduced,churn.stepwise<span class="fl">.2</span>,churn.stepwise<span class="fl">.1</span>,churn.stepwise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: Churn ~ SeniorCitizen + tenure + MultipleLines + InternetService + 
    Contract + PaperlessBilling + PaymentMethod + TotalCharges
Model 2: Churn ~ SeniorCitizen + tenure + MultipleLines + InternetService + 
    OnlineSecurity + Contract + PaperlessBilling + PaymentMethod + 
    TotalCharges
Model 3: Churn ~ SeniorCitizen + tenure + MultipleLines + InternetService + 
    OnlineSecurity + TechSupport + Contract + PaperlessBilling + 
    PaymentMethod + TotalCharges
Model 4: Churn ~ SeniorCitizen + tenure + MultipleLines + InternetService + 
    OnlineSecurity + TechSupport + StreamingMovies + Contract + 
    PaperlessBilling + PaymentMethod + TotalCharges
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      7018     5899.8                          
2      7017     5871.3  1   28.501 9.365e-08 ***
3      7016     5852.4  1   18.964 1.332e-05 ***
4      7015     5842.3  1   10.065  0.001511 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Model 2 is significantly better at explaining Churn. This stepwise model adds back in three variables to to the reduced model: OnlineSecurity, TechSupport, StreamingMovies.</p>
<section id="re-check-multicollinearity" class="level2">
<h2 class="anchored" data-anchor-id="re-check-multicollinearity">Re-check Multicollinearity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cond.index</span>(churn.stepwise, <span class="at">data=</span>churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.000000e+00 1.372306e+00 2.238997e+00 2.566460e+00 2.837376e+00
 [6] 2.951097e+00 3.286880e+00 3.574375e+00 3.943486e+00 4.141395e+00
[11] 4.519665e+00 4.935432e+00 5.210376e+00 5.864349e+00 7.229496e+00
[16] 1.119355e+01 1.709818e+01 3.861473e+08 8.428337e+08 2.159073e+09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cond.index</span>(churn.stepwise<span class="fl">.1</span>, <span class="at">data=</span>churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.000000e+00 1.482721e+00 2.141341e+00 2.450337e+00 2.707356e+00
 [6] 2.821385e+00 3.149718e+00 3.416094e+00 3.881858e+00 3.962582e+00
[11] 4.613957e+00 4.927430e+00 5.648598e+00 6.874077e+00 1.069470e+01
[16] 1.555776e+01 3.044554e+08 6.123331e+08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cond.index</span>(churn.stepwise<span class="fl">.2</span>, <span class="at">data=</span>churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.000000e+00 1.647890e+00 2.157724e+00 2.369799e+00 2.598730e+00
 [6] 2.762392e+00 3.033465e+00 3.290736e+00 3.759132e+00 4.364566e+00
[11] 4.731612e+00 5.384280e+00 6.597211e+00 1.022308e+01 1.443900e+01
[16] 4.363788e+08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cond.index</span>(churn.fit.reduced, <span class="at">data=</span>churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1.000000  1.851448  2.188398  2.371296  2.496958  2.842187  3.032654
 [8]  3.195287  4.156824  4.535447  5.204044  6.324844  9.710559 13.676272</code></pre>
</div>
</div>
</section>
</section>
<section id="model-selection" class="level1">
<h1>Model Selection</h1>
<section id="logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>churn.logreg <span class="ot">&lt;-</span> <span class="fu">glm</span>(Churn<span class="sc">~</span>SeniorCitizen<span class="sc">+</span>tenure<span class="sc">+</span>MultipleLines<span class="sc">+</span>InternetService<span class="sc">+</span>Contract<span class="sc">+</span>PaperlessBilling<span class="sc">+</span>PaymentMethod<span class="sc">+</span>TotalCharges,</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> churn)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(churn.logreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Churn ~ SeniorCitizen + tenure + MultipleLines + 
    InternetService + Contract + PaperlessBilling + PaymentMethod + 
    TotalCharges, family = binomial(link = "logit"), data = churn)

Coefficients:
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          -0.7524686  0.1216481  -6.186 6.19e-10 ***
SeniorCitizen                         0.2838042  0.0820511   3.459 0.000542 ***
tenure                               -0.0623101  0.0059172 -10.530  &lt; 2e-16 ***
MultipleLinesNo phone service         0.7163172  0.1296922   5.523 3.33e-08 ***
MultipleLinesYes                      0.2794728  0.0788261   3.545 0.000392 ***
InternetServiceFiber optic            0.9105034  0.0951849   9.566  &lt; 2e-16 ***
InternetServiceNo                    -0.5347664  0.1307872  -4.089 4.34e-05 ***
ContractOne year                     -0.7177526  0.1051426  -6.826 8.70e-12 ***
ContractTwo year                     -1.5309937  0.1736988  -8.814  &lt; 2e-16 ***
PaperlessBillingYes                   0.3843680  0.0734646   5.232 1.68e-07 ***
PaymentMethodCredit card (automatic) -0.0969663  0.1131124  -0.857 0.391303    
PaymentMethodElectronic check         0.3697148  0.0934143   3.958 7.56e-05 ***
PaymentMethodMailed check            -0.0803387  0.1135281  -0.708 0.479160    
TotalCharges                          0.0003168  0.0000630   5.029 4.94e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8143.4  on 7031  degrees of freedom
Residual deviance: 5899.8  on 7018  degrees of freedom
AIC: 5927.8

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(churn.logreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 5
   term                                  estimate std.error statistic  p.value
   &lt;chr&gt;                                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)                          -0.752    0.122        -6.19  6.19e-10
 2 SeniorCitizen                         0.284    0.0821        3.46  5.42e- 4
 3 tenure                               -0.0623   0.00592     -10.5   6.26e-26
 4 MultipleLinesNo phone service         0.716    0.130         5.52  3.33e- 8
 5 MultipleLinesYes                      0.279    0.0788        3.55  3.92e- 4
 6 InternetServiceFiber optic            0.911    0.0952        9.57  1.12e-21
 7 InternetServiceNo                    -0.535    0.131        -4.09  4.34e- 5
 8 ContractOne year                     -0.718    0.105        -6.83  8.70e-12
 9 ContractTwo year                     -1.53     0.174        -8.81  1.21e-18
10 PaperlessBillingYes                   0.384    0.0735        5.23  1.68e- 7
11 PaymentMethodCredit card (automatic) -0.0970   0.113        -0.857 3.91e- 1
12 PaymentMethodElectronic check         0.370    0.0934        3.96  7.56e- 5
13 PaymentMethodMailed check            -0.0803   0.114        -0.708 4.79e- 1
14 TotalCharges                          0.000317 0.0000630     5.03  4.94e- 7</code></pre>
</div>
</div>
<p>The polynomial model is significantly better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>log.odds <span class="ot">&lt;-</span> <span class="fu">coef</span>(churn.logreg)    </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(churn.logreg))</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> odds<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>odds)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(log.odds, odds, prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                          log.odds      odds      prob
(Intercept)                          -0.7524685955 0.4712019 0.3202836
SeniorCitizen                         0.2838041796 1.3281728 0.5704786
tenure                               -0.0623100773 0.9395915 0.4844275
MultipleLinesNo phone service         0.7163171797 2.0468810 0.6717955
MultipleLinesYes                      0.2794728130 1.3224325 0.5694170
InternetServiceFiber optic            0.9105034442 2.4855736 0.7131032
InternetServiceNo                    -0.5347664326 0.5858061 0.3694059
ContractOne year                     -0.7177525891 0.4878474 0.3278881
ContractTwo year                     -1.5309937176 0.2163206 0.1778483
PaperlessBillingYes                   0.3843680352 1.4686859 0.5949262
PaymentMethodCredit card (automatic) -0.0969662899 0.9075866 0.4757774
PaymentMethodElectronic check         0.3697148405 1.4473218 0.5913901
PaymentMethodMailed check            -0.0803387365 0.9228037 0.4799261
TotalCharges                          0.0003168002 1.0003169 0.5000792</code></pre>
</div>
</div>
<section id="testtrain-split" class="level3">
<h3 class="anchored" data-anchor-id="testtrain-split">Test/Train Split</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(churn)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(n,n<span class="sc">*</span><span class="fl">0.60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-variables" class="level3">
<h3 class="anchored" data-anchor-id="linear-variables">Linear Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>churn.logreg.linear.train <span class="ot">&lt;-</span> <span class="fu">glm</span>(Churn <span class="sc">~</span> SeniorCitizen <span class="sc">+</span> tenure <span class="sc">+</span> MultipleLines <span class="sc">+</span> InternetService <span class="sc">+</span> Contract <span class="sc">+</span> PaperlessBilling <span class="sc">+</span> PaymentMethod <span class="sc">+</span> TotalCharges,</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> churn[train,])</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(churn.logreg.linear.train, churn[<span class="sc">-</span>train,], <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Lowered the threshold manually to 0.35 just by trial and error</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(probs<span class="sc">&gt;</span><span class="fl">0.35</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>conf.mat <span class="ot">&lt;-</span> <span class="fu">table</span>(preds, churn<span class="sc">$</span>Churn[<span class="sc">-</span>train])</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>TruN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">1</span>] <span class="co"># True negatives, row 1 col 1</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>TruP<span class="ot">=</span>conf.mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="co"># True positives, row 2 col 2</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>FalP<span class="ot">=</span>conf.mat[<span class="dv">2</span>,<span class="dv">1</span>] <span class="co"># False positives, etc.</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>FalN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">2</span>] <span class="co"># False negatives</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>TotN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> conf.mat[<span class="dv">2</span>,<span class="dv">1</span>] <span class="co"># Total negatives</span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>TotP<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> conf.mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="co"># Total positives</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>Tot<span class="ot">=</span>TotN<span class="sc">+</span>TotP <span class="co"># Matrix total</span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>Accuracy<span class="ot">=</span>(TruN<span class="sc">+</span>TruP)<span class="sc">/</span>Tot</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>Error<span class="ot">=</span>(FalN<span class="sc">+</span>FalP)<span class="sc">/</span>Tot</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>Sensitivity<span class="ot">=</span>TruP<span class="sc">/</span>TotP <span class="co"># Proportion of correct positives</span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>Specificity<span class="ot">=</span>TruN<span class="sc">/</span>TotN <span class="co"># Proportion of correct negatives</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>FalPos <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> Specificity</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"Accuracy"</span><span class="ot">=</span>Accuracy,</span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error"</span><span class="ot">=</span>Error,</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sensitivity"</span><span class="ot">=</span>Sensitivity,</span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Specificity"</span><span class="ot">=</span>Specificity,</span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"False Positives"</span><span class="ot">=</span>FalPos), <span class="at">digits=</span><span class="dv">2</span>) <span class="co"># Prints fewer digits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Accuracy           Error     Sensitivity     Specificity False Positives 
           0.77            0.23            0.70            0.80            0.20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>logreg.linear.rates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span><span class="ot">=</span>Accuracy,</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error"</span><span class="ot">=</span>Error,</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sensitivity"</span><span class="ot">=</span>Sensitivity,</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Specificity"</span><span class="ot">=</span>Specificity,</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"False Positives"</span><span class="ot">=</span>FalPos)</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(preds,churn<span class="sc">$</span>Churn[<span class="sc">-</span>train])</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf,<span class="at">colorize=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/churn.logreg.linear.train-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred,<span class="st">"auc"</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(auc<span class="sc">@</span>y.name[[<span class="dv">1</span>]], auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area under the ROC curve" "0.752133952220864"       </code></pre>
</div>
</div>
</section>
</section>
<section id="linear-discriminant-analysis" class="level2">
<h2 class="anchored" data-anchor-id="linear-discriminant-analysis">Linear Discriminant Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>churn.lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(Churn <span class="sc">~</span> SeniorCitizen <span class="sc">+</span> tenure <span class="sc">+</span> MultipleLines <span class="sc">+</span> InternetService <span class="sc">+</span> Contract <span class="sc">+</span> PaperlessBilling <span class="sc">+</span> PaymentMethod <span class="sc">+</span> TotalCharges,</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> churn[train,])</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(churn.lda,churn[<span class="sc">-</span>train,])<span class="sc">$</span>posterior[,<span class="dv">2</span>]</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(preds <span class="sc">&gt;</span> <span class="fl">0.35</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>conf.mat <span class="ot">&lt;-</span> <span class="fu">table</span>(preds, churn<span class="sc">$</span>Churn[<span class="sc">-</span>train])</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>TruN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">1</span>] <span class="co"># True negatives, row 1 col 1</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>TruP<span class="ot">=</span>conf.mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="co"># True positives, row 2 col 2</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>FalP<span class="ot">=</span>conf.mat[<span class="dv">2</span>,<span class="dv">1</span>] <span class="co"># False positives, etc.</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>FalN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">2</span>] <span class="co"># False negatives</span></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>TotN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> conf.mat[<span class="dv">2</span>,<span class="dv">1</span>] <span class="co"># Total negatives</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>TotP<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> conf.mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="co"># Total positives</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>Tot<span class="ot">=</span>TotN<span class="sc">+</span>TotP <span class="co"># Matrix total</span></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>Accuracy<span class="ot">=</span>(TruN<span class="sc">+</span>TruP)<span class="sc">/</span>Tot</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>Error<span class="ot">=</span>(FalN<span class="sc">+</span>FalP)<span class="sc">/</span>Tot</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>Sensitivity<span class="ot">=</span>TruP<span class="sc">/</span>TotP <span class="co"># Proportion of correct positives</span></span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>Specificity<span class="ot">=</span>TruN<span class="sc">/</span>TotN <span class="co"># Proportion of correct negatives</span></span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>FalPos <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> Specificity</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"Accuracy"</span><span class="ot">=</span>Accuracy,</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error"</span><span class="ot">=</span>Error,</span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sensitivity"</span><span class="ot">=</span>Sensitivity,</span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Specificity"</span><span class="ot">=</span>Specificity,</span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"False Positives"</span><span class="ot">=</span>FalPos), <span class="at">digits=</span><span class="dv">2</span>) <span class="co"># Prints fewer digits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Accuracy           Error     Sensitivity     Specificity False Positives 
           0.78            0.22            0.67            0.82            0.18 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>lda.rates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span><span class="ot">=</span>Accuracy,</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error"</span><span class="ot">=</span>Error,</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sensitivity"</span><span class="ot">=</span>Sensitivity,</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Specificity"</span><span class="ot">=</span>Specificity,</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"False Positives"</span><span class="ot">=</span>FalPos)</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(preds,churn<span class="sc">$</span>Churn[<span class="sc">-</span>train])</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf,<span class="at">colorize=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred,<span class="st">"auc"</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(auc<span class="sc">@</span>y.name[[<span class="dv">1</span>]], auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area under the ROC curve" "0.745390497656887"       </code></pre>
</div>
</div>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">Random Forest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>churn.rf <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(<span class="fu">as.factor</span>(Churn) <span class="sc">~</span> SeniorCitizen <span class="sc">+</span> tenure <span class="sc">+</span> MultipleLines <span class="sc">+</span> InternetService <span class="sc">+</span> Contract <span class="sc">+</span> PaperlessBilling <span class="sc">+</span> PaymentMethod <span class="sc">+</span> TotalCharges,</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> churn[train,],</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">importance=</span>T,</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry=</span><span class="dv">8</span>)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(churn.rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(churn.rf) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(churn.rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           0          1 MeanDecreaseAccuracy MeanDecreaseGini
SeniorCitizen     23.5077591  0.7560151            19.563656         47.31397
tenure            32.9029022 23.3693999            58.278776        277.99436
MultipleLines      0.9373841 10.7603795             8.315747         48.39879
InternetService   13.7052240 52.6497915            51.015557        108.51806
Contract         -22.9653530 78.9509570            39.353273        276.79717
PaperlessBilling   0.8453461 16.2492299            11.320629         53.43850
PaymentMethod     -0.4391000 15.8995179            10.606852        105.40043
TotalCharges      20.2527629  5.7149302            30.235313        699.33935</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Learned how to produce probabilites from trees here: https://stackoverflow.com/questions/64651101/is-there-a-way-to-change-threshold-of-a-classification-within-a-model-in-caret-r</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(churn.rf,churn[<span class="sc">-</span>train,], <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>]</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(probs<span class="sc">&gt;</span><span class="fl">0.35</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>conf.mat <span class="ot">&lt;-</span> <span class="fu">table</span>(preds, churn<span class="sc">$</span>Churn[<span class="sc">-</span>train])</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>TruN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">1</span>] <span class="co"># True negatives, row 1 col 1</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>TruP<span class="ot">=</span>conf.mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="co"># True positives, row 2 col 2</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>FalP<span class="ot">=</span>conf.mat[<span class="dv">2</span>,<span class="dv">1</span>] <span class="co"># False positives, etc.</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>FalN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">2</span>] <span class="co"># False negatives</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>TotN<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> conf.mat[<span class="dv">2</span>,<span class="dv">1</span>] <span class="co"># Total negatives</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>TotP<span class="ot">=</span>conf.mat[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> conf.mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="co"># Total positives</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>Tot<span class="ot">=</span>TotN<span class="sc">+</span>TotP <span class="co"># Matrix total</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>Accuracy<span class="ot">=</span>(TruN<span class="sc">+</span>TruP)<span class="sc">/</span>Tot</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>Error<span class="ot">=</span>(FalN<span class="sc">+</span>FalP)<span class="sc">/</span>Tot</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>Sensitivity<span class="ot">=</span>TruP<span class="sc">/</span>TotP <span class="co"># Proportion of correct positives</span></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>Specificity<span class="ot">=</span>TruN<span class="sc">/</span>TotN <span class="co"># Proportion of correct negatives</span></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>FalPos <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> Specificity</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"Accuracy"</span><span class="ot">=</span>Accuracy,</span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error"</span><span class="ot">=</span>Error,</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sensitivity"</span><span class="ot">=</span>Sensitivity,</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Specificity"</span><span class="ot">=</span>Specificity,</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"False Positives"</span><span class="ot">=</span>FalPos), <span class="at">digits=</span><span class="dv">2</span>) <span class="co"># Prints fewer digits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Accuracy           Error     Sensitivity     Specificity False Positives 
           0.77            0.23            0.70            0.80            0.20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>rf.rates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span><span class="ot">=</span>Accuracy,</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Error"</span><span class="ot">=</span>Error,</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sensitivity"</span><span class="ot">=</span>Sensitivity,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Specificity"</span><span class="ot">=</span>Specificity,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"False Positives"</span><span class="ot">=</span>FalPos)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert preds to numeric</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(preds) <span class="sc">==</span> <span class="st">'0'</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(preds,churn<span class="sc">$</span>Churn[<span class="sc">-</span>train])</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf,<span class="at">colorize=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="customerchurn_prelim_da_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred,<span class="st">"auc"</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(auc<span class="sc">@</span>y.name[[<span class="dv">1</span>]], auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area under the ROC curve" "0.752133952220864"       </code></pre>
</div>
</div>
</section>
</section>
<section id="models-performance-summary" class="level1">
<h1>Models Performance Summary</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(logreg.linear.rates,lda.rates,rf.rates),<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Accuracy   Error Sensitivity Specificity False Positives
logreg.linear.rates  0.77497 0.22503     0.70182     0.80244         0.19756
lda.rates            0.77817 0.22183     0.67318     0.81760         0.18240
rf.rates             0.77497 0.22503     0.70182     0.80244         0.19756</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>